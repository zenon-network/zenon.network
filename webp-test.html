<!DOCTYPE html>
<html>
<head>
    <title>WebP Loading Test</title>
    <script src="./js/webp-detect.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a1a; color: #fff; }
        .test { margin: 20px 0; padding: 20px; background: #2a2a2a; border-radius: 8px; }
        img { max-width: 200px; margin: 10px; border: 2px solid #444; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #2d5a2d; }
        .error { background: #5a2d2d; }
    </style>
</head>
<body>
    <h1>WebP Image Loading Test</h1>
    
    <div class="test">
        <h2>WebP Support Detection</h2>
        <div id="webp-support" class="status"></div>
    </div>
    
    <div class="test">
        <h2>Direct Image Loading Test</h2>
        <p>These images have both PNG and WebP versions:</p>
        
        <div>
            <h3>Ball Image</h3>
            <img data-webp="./img/ball.webp" src="./img/ball.png" alt="Ball" id="ball-img">
            <div id="ball-status"></div>
        </div>
        
        <div>
            <h3>Network Image</h3>
            <img data-webp="./img/network.webp" src="./img/network.png" alt="Network" id="network-img">
            <div id="network-status"></div>
        </div>
        
        <div>
            <h3>Funding Image</h3>
            <img data-webp="./img/funding.webp" src="./img/funding.png" alt="Funding" id="funding-img">
            <div id="funding-status"></div>
        </div>
    </div>
    
    <div class="test">
        <h2>Background Image Test</h2>
        <div id="bg-test" style="width: 300px; height: 200px; background-size: cover;"></div>
        <div id="bg-status"></div>
    </div>
    
    <script>
        // Wait for WebP detection to complete
        setTimeout(() => {
            // Check WebP support
            const webpSupported = document.documentElement.classList.contains('webp');
            document.getElementById('webp-support').innerHTML = 
                webpSupported ? 
                '<strong class="success">✅ WebP is supported!</strong>' : 
                '<strong class="error">❌ WebP is NOT supported</strong>';
            
            // Check each image
            ['ball', 'network', 'funding'].forEach(name => {
                const img = document.getElementById(name + '-img');
                const status = document.getElementById(name + '-status');
                const isWebP = img.src.includes('.webp');
                
                status.innerHTML = isWebP ? 
                    `✅ Loading WebP version: ${img.src.split('/').pop()}` :
                    `❌ Loading PNG version: ${img.src.split('/').pop()}`;
                
                // Also check actual file size
                fetch(img.src, {method: 'HEAD'}).then(r => {
                    const size = r.headers.get('content-length');
                    status.innerHTML += ` (${(size/1024).toFixed(1)}KB)`;
                });
            });
            
            // Test background image
            const bgTest = document.getElementById('bg-test');
            const bgStatus = document.getElementById('bg-status');
            
            if (webpSupported) {
                bgTest.style.backgroundImage = 'url(./img/star-background.webp)';
                bgStatus.innerHTML = '✅ Background using WebP';
            } else {
                bgTest.style.backgroundImage = 'url(./img/star-background.png)';
                bgStatus.innerHTML = '❌ Background using PNG';
            }
            
        }, 500);
    </script>
</body>
</html>